# GAYM 프로젝트 분석

## 프로젝트 개요
이 프로젝트는 DirectX 12를 사용하여 3D 렌더링을 구현한 C++ 애플리케이션입니다. 컴포넌트 기반 게임 오브젝트 시스템, 계층적 씬 그래프(Scene Graph), 물리 기반 렌더링(PBR) 요소가 포함된 머티리얼 구조, 그리고 OBB(Oriented Bounding Box) 기반의 충돌 처리 시스템을 갖춘 커스텀 게임 엔진 아키텍처를 구현하고 있습니다. 3D 모델 로딩, 정교한 입력 처리, 동적 카메라 시스템을 지원합니다.

## 디렉토리 구조
```
gaym/
├── .gitignore
├── README.md
├── docs/                   # 문서 폴더 (분석 문서 포함)
└── gaym/                   # 메인 프로젝트 소스 및 리소스
    ├── .vs/                # Visual Studio 구성
    ├── .vscode/            # VS Code 구성
    ├── Animation/          # 애니메이션 데이터 (.bin, .txt)
    ├── Model/              # 3D 모델 에셋 (.bin, .fbx, .png, .mat)
    ├── x64/                # 빌드 아티팩트
    ├── 소스 파일 (.cpp, .h) # 핵심 엔진 및 게임 로직
    ├── 셰이더 (.hlsl)       # HLSL 셰이더 코드
    └── 리소스 (.rc, .ico)   # 윈도우 리소스
```

## 핵심 아키텍처

### 1. 애플리케이션 진입 및 수명 주기 (`Dx12App`)
표준 Win32 (`wWinMain`) 진입점을 사용하며, `Dx12App` 클래스가 D3D12 런타임을 관리합니다.
- **초기화**: Device, Command Queue, Swap Chain, RTV/DSV Descriptor Heap, Frame Resources 설정.
- **게임 루프**: `FrameAdvance()`를 통해 Update -> Render -> Present 주기를 실행.
- **메시지 펌프**: Win32 메시지를 처리하고 `InputSystem`으로 전달.

### 2. 게임 오브젝트 시스템 (`GameObject`, `Component`)
구성(Composition) 패턴을 기반으로 유연한 객체 확장을 지원합니다.
- **GameObject**: 엔티티의 기본 단위.
    - **컴포넌트 관리**: `AddComponent`, `GetComponent` 등을 통해 기능 확장.
    - **계층 구조**: `m_pParent`, `m_pChild`, `m_pSibling`을 통한 씬 그래프 지원.
- **주요 컴포넌트**:
    - **TransformComponent**: 위치, 회전, 스케일 관리 및 행렬 계산.
    - **RenderComponent**: 메쉬와 셰이더 연결, 렌더링 수행.
    - **PlayerComponent**: 플레이어 입력 처리 및 카메라/이동 로직 제어.
    - **RotatorComponent**: 매 프레임 지정된 속도로 객체를 회전 (장식물, 회전체 등).
    - **ColliderComponent**: OBB(Oriented Bounding Box) 충돌체. `TransformComponent`와 연동되어 위치/회전 동기화 및 충돌 감지(`Intersects`) 수행.
    - **InputComponent**: 객체 단위의 키 상태 관리 (현재 `InputSystem`과 연동 구조).

### 3. 씬 관리 (`Scene`)
- **관리**: 모든 `GameObject`의 생성, 업데이트, 삭제 관리.
- **리소스**: 셰이더, 텍스처, 모델 등 공유 리소스 로딩 및 관리.
- **카메라**: `CCamera` 인스턴스를 소유하여 뷰/프로젝션 행렬 계산.

### 4. 렌더링 파이프라인
- **D3D12 추상화**: `CDescriptorHeap`을 통해 복잡한 디스크립터 힙 생성 및 핸들(CPU/GPU) 관리를 단순화.
- **Shader**: Root Signature 및 PSO 관리. `RenderComponent`들을 그룹화하여 효율적인 드로우 콜 발행.
- **Mesh**: 정점/인덱스 버퍼 관리. `MeshFromFile` 및 조명 처리를 위한 확장 클래스 지원.
- **Lighting**: `PassConstants`를 통해 Directional, Point, Spot, Ambient 라이트 지원. PBR 요소(Ambient, Diffuse, Specular, Emissive)를 포함한 머티리얼 시스템.

### 5. 입력 시스템 (`InputSystem`)
- **InputSystem**: 전역 입력 관리자. 키보드 상태(256키), 마우스 위치, 델타 값(이동량), 휠 상태를 추적.
- **처리 흐름**: Win32 메시지 -> `InputSystem::On...` -> `PlayerComponent` 등에서 쿼리.

## 주요 클래스 상세

### `CDescriptorHeap`
- D3D12 디스크립터 힙의 생성(`Create`)과 핸들 접근(`GetCPUHandle`, `GetGPUHandle`)을 캡슐화하여 보일러플레이트 코드를 감소시킴.

### `ColliderComponent`
- `DirectXCollision.h`의 `BoundingOrientedBox`를 사용.
- `Init`: 초기 바운딩 박스 설정.
- `Update`: 소유자의 `TransformComponent` 월드 행렬을 기반으로 바운딩 박스 변환.
- `Intersects`: 다른 콜라이더와의 교차 검사.

### `PlayerComponent`
- 플레이어 특화 로직 구현. `InputSystem`과 `CCamera` 참조를 받아 3인칭 이동 또는 카메라 제어 로직을 수행하는 것으로 보임.

## 구현된 기능 요약
1.  **DirectX 12 렌더링**: Descriptor Heap 추상화 등을 포함한 견고한 렌더링 백엔드.
2.  **물리/충돌**: OBB 기반의 3D 충돌 감지 시스템.
3.  **씬 그래프 & 트랜스폼**: 부모-자식 관계를 지원하는 계층적 변환 시스템.
4.  **확장 가능한 컴포넌트 구조**: 렌더링, 물리, 입력, 게임 로직(Player/Rotator)이 모듈화됨.
5.  **에셋 파이프라인**: 커스텀 바이너리/FBX 모델 및 애니메이션 데이터 로딩 지원.

## 분석된 파일
- **Core**: `gaym.cpp`, `Dx12App.h/cpp`, `stdafx.h`
- **System**: `InputSystem.h/cpp`, `Timer.h/cpp`, `DescriptorHeap.h/cpp`
- **Object**: `GameObject.h/cpp`, `Scene.h/cpp`
- **Component**: `Component.h`, `TransformComponent.h`, `RenderComponent.h`, `PlayerComponent.h`, `RotatorComponent.h`, `ColliderComponent.h`, `InputComponent.h`
- **Render**: `Camera.h`, `Mesh.h`, `Shader.h`